import sqlite3
import os
import sys


def resource_path(relative_path):
    if hasattr(sys, "_MEIPASS"):
        return os.path.join(sys._MEIPASS, relative_path)
    return os.path.join(os.path.abspath("."), relative_path)


DB_NAME = resource_path("Library_items.db")


def dump_database():
    conn = sqlite3.connect(DB_NAME)
    cur = conn.cursor()

    print("\nITEMS")
    cur.execute("""
        SELECT
            i.id,
            i.name,
            i.description,
            i.example,
            l.name AS library
        FROM items i
        JOIN library l ON l.id = i.library_id
        ORDER BY l.name, i.name;
    """)
    for row in cur.fetchall():
        print(row)

    conn.close()


if __name__ == "__main__":
    dump_database()

